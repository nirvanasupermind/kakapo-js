"use strict";Array.prototype.flat||(Array.prototype.flat=function(r,t){return t=this.concat.apply([],this),1<r&&t.some(Array.isArray)?t.flat(r-1):t},Array.prototype.flatMap=function(r,t){return this.map(r,t).flat()});var kakapo=new function(){function r(r){this._=r}function o(n){return n=String(n),new r(function(r){if(r===n)return a(n,0,n.length);for(var t=0;r.charAt(t)===n.charAt(t)&&t<Math.max(r.length,n.length);)t++;return s(t)})}r.prototype.parse=function(r){return r=String(r),void 0!==this._(r).value?this._(r).value:this._(r)},r.prototype.or=function(t){var n=this;return new r(function(r){return(f(n._(r))?t:n)._(r)})},r.prototype.then=function(o){var i=this;return new r(function(r){for(var t=0;t<r.length&&f(o._(r.substring(t)));)t++;var n=i._(r.substring(0,t)),e=o._(r.substring(t));return f(n)?n:f(e)?s(e.index+t):a([n.value,e.value],n.start,e.end+t)})},r.prototype.quantified=function(r,t){for(var n=i(this,r),e=r+1;e<=t;e++)n=n.or(i(this,e));return n},r.prototype.repeat=function(r){return this.quantified(r,r)},r.prototype.opt=function(r){return o("").or(this)},r.prototype.zeroOrMore=function(){var u=this;return new r(function(r){for(var t=0,n=[],e=0,o=0;;){o++;var i=u._(r.substring(t));if(5e3===o)return s(i.error.index+t);if(!f(i)){n.push(u._(r.substring(t)).value);break}i=i.error.index;if(e+=i,i+t>=r.length)break;n.push(u._(r.substring(t=i)).value)}return a(n,0,e+1)})},r.prototype.oneOrMore=function(){return this.then(this.zeroOrMore()).transform(r=>r[0].concat(r[1]))},r.prototype.transform=function(t){var n=this;return new r(function(r){r=n._(r);return f(r)?r:a(t(r.value),r.start,r.end)})},r.prototype.delimited=function(r){return this.then(r.then(this).zeroOrMore()).transform(r=>[r[0],...r[1].map(r=>r[1])])};function a(r,t,n){return{value:r,start:parseFloat(t),end:parseFloat(n)}}function s(r){return{error:{index:parseFloat(r)}}}function f(r){return r&&r.error}function i(r,t){if(0===t)return o("").transform(()=>[]);if(1===t)return r.transform(r=>[r]);for(var n=r.then(r),e=2;e<t;e++)n=n.then(r).transform(r=>[...r[0],...r.slice(1)]);return n}this.Parser=r,this.text=o,this.char=function(r){for(var t=o((r=""+r).charAt(0)),n=1;n<r.length;n++)t=t.or(o(r.charAt(n)));return t},this.success=a,this.failure=s,this.delay=function(t){var n=new kakapo.Parser(function(r){return n._=t()._,n._(r)});return n}};"object"==typeof module&&module.exports?module.exports=kakapo:"function"==typeof define&&define([],function(){return kakapo});